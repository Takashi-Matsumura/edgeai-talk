# RAG機能動作確認用テストプロンプト

このドキュメントには、RAG機能が正しく動作しているかを確認するためのテストプロンプトと期待される回答例が含まれています。

## 🧪 テスト方法

1. EdgeAI Talkアプリケーションを開く
2. 以下のプロンプトを入力
3. 回答がアップロードしたドキュメントの内容を反映しているか確認

## ✅ テストケース

---

### テストケース 1: 会社基本情報

**プロンプト:**
```
EdgeAI株式会社の設立日と資本金を教えてください
```

**期待される回答（RAG有効時）:**
```
EdgeAI株式会社の基本情報についてお答えします。

- 設立: 2020年4月1日
- 資本金: 5億円

また、同社は東京都渋谷区桜丘町1-1に所在し、2025年1月現在で従業員数は150名、
代表取締役は山田太郎氏です。エッジコンピューティングとAI技術を専門とする
先端技術企業です。
```

**RAG無効時の挙動:**
```
申し訳ございませんが、EdgeAI株式会社の具体的な設立日や資本金については
私の知識にはありません。公式ウェブサイトや企業情報をご確認ください。
```

**検証ポイント:**
- ✅ 設立日（2020年4月1日）が正確に含まれているか
- ✅ 資本金（5億円）が正確に含まれているか
- ✅ その他の会社情報（所在地、従業員数など）が含まれているか

---

### テストケース 2: 製品機能の詳細

**プロンプト:**
```
EdgeAI Talkの音声認識の精度はどれくらいですか？
```

**期待される回答（RAG有効時）:**
```
EdgeAI Talkの音声認識精度についてお答えします。

EdgeAI Talkでは Web Speech API を使用しており、日本語の認識精度は約95%です。
最適な精度を得るためには、静かな環境での使用が推奨されています。

なお、音声認識を使用するにはHTTPS接続が必要で、タップ&ホールド方式で
音声入力が可能です。
```

**RAG無効時の挙動:**
```
EdgeAI Talkの具体的な音声認識精度については、私の知識にはございません。
一般的な音声認識システムでは、環境や話者によって精度が変わります。
```

**検証ポイント:**
- ✅ 精度「約95%」が含まれているか
- ✅ Web Speech API の使用が言及されているか
- ✅ 静かな環境での使用推奨が含まれているか

---

### テストケース 3: 技術仕様の詳細

**プロンプト:**
```
EdgeAI Talkで使用しているRAGバックエンドの埋め込みモデルとベクトル次元を教えてください
```

**期待される回答（RAG有効時）:**
```
EdgeAI TalkのRAGバックエンドの技術仕様は以下の通りです：

- ベクトルDB: ChromaDB
- 埋め込みモデル: intfloat/multilingual-e5-base
- ベクトル次元: 768
- 類似度閾値: 0.5以上

RAG Backend APIは http://localhost:8000 で動作しており、
ドキュメントの意味的検索と文脈に基づいた回答生成を実現しています。
```

**RAG無効時の挙動:**
```
申し訳ございませんが、EdgeAI TalkのRAGバックエンドの具体的な
技術仕様については私の知識にはありません。
```

**検証ポイント:**
- ✅ 埋め込みモデル名（intfloat/multilingual-e5-base）が含まれているか
- ✅ ベクトル次元（768）が含まれているか
- ✅ ChromaDBの使用が言及されているか

---

### テストケース 4: システム要件

**プロンプト:**
```
EdgeAI Talkのサーバー側で推奨されるメモリとCPUの仕様を教えてください
```

**期待される回答（RAG有効時）:**
```
EdgeAI Talkのサーバー側の推奨システム要件は以下の通りです：

- CPU: 4コア以上推奨
- メモリ: 8GB以上（16GB推奨）
- ストレージ: 10GB以上の空き容量

その他の要件として：
- Node.js: 20.x以降
- Docker: 20.10以降（VOICEVOX使用時）
- Python: 3.11以降（RAGバックエンド使用時）

対応OS: macOS 12以降、Ubuntu 20.04以降、Windows 10/11
```

**RAG無効時の挙動:**
```
一般的なNext.jsアプリケーションとしては、4GB以上のメモリと
2コア以上のCPUがあれば動作しますが、EdgeAI Talkの具体的な
推奨仕様については確認できません。
```

**検証ポイント:**
- ✅ メモリ要件（8GB以上、16GB推奨）が含まれているか
- ✅ CPU要件（4コア以上）が含まれているか
- ✅ その他の要件（Node.js, Docker, Python）が含まれているか

---

### テストケース 5: トラブルシューティング

**プロンプト:**
```
音声入力が動作しない場合、どのような確認をすればよいですか？
```

**期待される回答（RAG有効時）:**
```
音声入力が動作しない場合は、以下の点を確認してください：

1. HTTPS接続を使用しているか
2. マイク許可を承認したか
3. 音声モードがONになっているか

EdgeAI Talkでは音声認識にWeb Speech APIを使用しており、
セキュリティ上の理由からHTTPS接続が必須となっています。
ブラウザでマイクへのアクセス許可を求められた際には、
必ず「許可」を選択してください。
```

**RAG無効時の挙動:**
```
一般的な音声入力のトラブルシューティングとしては：
- マイクが正しく接続されているか確認
- ブラウザの権限設定を確認
- デバイスのマイク設定を確認
などが挙げられます。
```

**検証ポイント:**
- ✅ HTTPS接続の確認が含まれているか
- ✅ マイク許可の確認が含まれているか
- ✅ 音声モードONの確認が含まれているか

---

### テストケース 6: 複数ドキュメントからの統合回答

**プロンプト:**
```
EdgeAI Talkはどのような対応ブラウザで動作し、どのような機能を持っていますか？
```

**期待される回答（RAG有効時）:**
```
EdgeAI Talkの対応ブラウザと機能についてお答えします。

【対応ブラウザ】
- Safari 14以降（iOS/iPadOS）
- Chrome 90以降
- Edge 90以降
- Firefox 88以降
※ネットワーク: ローカルネットワーク接続（オフライン動作可能）

【主な機能】
- 音声入力（タップ&ホールド）
- テキスト入力
- 音声読み上げ（VOICEVOX）
- リアルタイムストリーミング応答
- 会話履歴の保存
- PWAとしてホーム画面に追加可能

推奨デバイスはiPad mini 6（縦型レイアウト最適化）ですが、
iPhone、Android、デスクトップブラウザでも動作します。
```

**RAG無効時の挙動:**
```
EdgeAI Talkの具体的な対応ブラウザや機能の詳細については、
ドキュメントをご確認ください。
```

**検証ポイント:**
- ✅ 対応ブラウザのリストが含まれているか
- ✅ 主な機能のリストが含まれているか
- ✅ 推奨デバイス（iPad mini 6）が含まれているか
- ✅ 複数のドキュメント（FAQ + 技術仕様書）の情報が統合されているか

---

### テストケース 7: LLMモデルの詳細

**プロンプト:**
```
EdgeAI Talkで推奨されているLLMモデルのパラメータ数とメモリ使用量を教えてください
```

**期待される回答（RAG有効時）:**
```
EdgeAI Talkで推奨されているLLMモデルは google/gemma-3n-e4b で、
以下の仕様となっています：

- パラメータ数: 3B（3ビリオン）
- 量子化: 4-bit
- メモリ使用量: 約2GB
- 推論速度: 約20トークン/秒（M1 Max使用時）

その他の対応モデルとしては：
- Llama 3.2 (1B, 3B)
- Phi-3 Mini
- Qwen 2.5 (0.5B, 1.5B, 3B)

すべてのモデルはOpenAI互換API対応、コンテキスト長2048トークン以上、
ストリーミング対応が必要です。
```

**RAG無効時の挙動:**
```
EdgeAI Talkの具体的な推奨モデルについては私の知識にはありませんが、
一般的に3Bパラメータのモデルは2-4GB程度のメモリを使用します。
```

**検証ポイント:**
- ✅ モデル名（google/gemma-3n-e4b）が含まれているか
- ✅ パラメータ数（3B）が含まれているか
- ✅ メモリ使用量（約2GB）が含まれているか
- ✅ 推論速度（約20トークン/秒）が含まれているか

---

## 📊 RAG動作確認のポイント

### ✅ RAGが正しく動作している場合
1. **具体的な数値や固有名詞が含まれている**
   - 設立日、資本金、従業員数など
   - 精度95%、ベクトル次元768など

2. **ドキュメントの文脈が反映されている**
   - アップロードした文書の内容そのものが引用されている
   - 複数のドキュメントから情報が統合されている

3. **一貫性のある回答**
   - ドキュメントに記載されていない情報は「不明」と答える
   - ドキュメント内の情報を優先的に使用する

### ❌ RAGが動作していない場合
1. **一般的な回答のみ**
   - 「公式サイトをご確認ください」
   - 「一般的には～」という曖昧な表現

2. **具体的な情報が欠落**
   - 数値や固有名詞が含まれていない
   - ドキュメントの内容と矛盾する情報

3. **知識の不足を示す回答**
   - 「私の知識にはありません」
   - 「詳細は不明です」

---

## 🔍 検証用コマンド

### RAG検索の直接テスト
```bash
curl -X POST http://localhost:8000/api/rag/query \
  -H "Content-Type: application/json" \
  -d '{
    "query": "EdgeAI株式会社の設立日",
    "top_k": 2
  }'
```

### ドキュメント統計の確認
```bash
curl http://localhost:8000/api/documents/count
```

### ドキュメント一覧の確認
```bash
curl http://localhost:8000/api/documents/list
```

---

## 📝 実施記録テンプレート

各テストケース実施後、以下の形式で記録することを推奨します：

```
テストケース: [番号と名前]
実施日時: [YYYY-MM-DD HH:MM]
RAG有効: [はい/いいえ]
結果: [成功/失敗]
実際の回答:
"""
[LLMからの実際の回答をここに記録]
"""
検証ポイント達成度: [X/Y項目]
備考: [気づいた点があれば記入]
```
