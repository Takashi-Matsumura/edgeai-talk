EdgeAI Talk - 技術仕様書

============================================================
1. システム要件
============================================================

【サーバー側】
- OS: macOS 12以降、Ubuntu 20.04以降、Windows 10/11
- CPU: 4コア以上推奨
- メモリ: 8GB以上（16GB推奨）
- ストレージ: 10GB以上の空き容量
- Node.js: 20.x以降
- Docker: 20.10以降（VOICEVOX使用時）
- Python: 3.11以降（RAGバックエンド使用時）

【クライアント側】
- 対応ブラウザ:
  * Safari 14以降（iOS/iPadOS）
  * Chrome 90以降
  * Edge 90以降
  * Firefox 88以降
- ネットワーク: ローカルネットワーク接続（オフライン動作可能）

============================================================
2. LLMモデル仕様
============================================================

【推奨モデル】
- google/gemma-3n-e4b (3Bパラメータ)
  * 量子化: 4-bit
  * メモリ使用量: 約2GB
  * 推論速度: 約20トークン/秒（M1 Max）

【対応モデル】
- Llama 3.2 (1B, 3B)
- Phi-3 Mini
- Qwen 2.5 (0.5B, 1.5B, 3B)

【モデル要件】
- OpenAI互換API対応
- コンテキスト長: 2048トークン以上
- ストリーミング対応

============================================================
3. API仕様
============================================================

【LM Studio API】
- エンドポイント: http://localhost:1234/v1/chat/completions
- プロトコル: HTTP/1.1
- レスポンス形式: Server-Sent Events (SSE)
- タイムアウト: 120秒

【VOICEVOX API】
- エンドポイント: http://localhost:50021
- 話者ID: 3（ずんだもん標準）
- 音声形式: WAV (PCM 24kHz 16bit)
- レイテンシ: 約100-200ms

【RAG Backend API】
- エンドポイント: http://localhost:8000
- ベクトルDB: ChromaDB
- 埋め込みモデル: intfloat/multilingual-e5-base
- ベクトル次元: 768
- 類似度閾値: 0.5以上

============================================================
4. ネットワーク仕様
============================================================

【ポート使用】
- 3000: Next.jsアプリケーション（HTTPS）
- 1234: LM Studio API
- 8000: RAG Backend (FastAPI)
- 50021: VOICEVOX Engine

【通信プロトコル】
- フロントエンド ⇔ Next.js: HTTPS (TLS 1.3)
- Next.js ⇔ LM Studio: HTTP
- Next.js ⇔ RAG Backend: HTTP
- Next.js ⇔ VOICEVOX: HTTP

【SSL/TLS】
- 証明書: 自己署名証明書（開発用）
- アルゴリズム: RSA 4096bit
- 有効期限: 365日

============================================================
5. パフォーマンス指標
============================================================

【レスポンス時間】
- 音声認識: 1-2秒（Web Speech API依存）
- LLM初回トークン: 0.5-1秒
- LLMストリーミング: 20-30トークン/秒
- 音声合成: 100-200ms

【リソース使用量】
- Next.jsプロセス: 100-200MB
- LM Studio: 2-4GB（モデル依存）
- ChromaDB: 100-500MB（データ量依存）
- VOICEVOX: 200-400MB

【スケーラビリティ】
- 同時接続数: 最大10セッション（開発環境）
- 最大メッセージ長: 2000文字
- 会話履歴保持: 最大50メッセージ

============================================================
6. セキュリティ仕様
============================================================

【データ保護】
- すべての処理はローカル実行
- 外部サーバーへのデータ送信なし
- ブラウザストレージのみ使用

【認証・認可】
- 現バージョン: 認証なし（ローカル専用）
- 将来バージョン: Basic認証対応予定

【HTTPS】
- 必須（音声認識API要件）
- 自己署名証明書使用
- 本番環境では正式証明書推奨

============================================================
7. ログ・モニタリング
============================================================

【ログレベル】
- INFO: 通常動作ログ
- WARNING: 警告（フォールバック時など）
- ERROR: エラー発生時

【ログ出力先】
- Next.js: stdout
- LM Studio: アプリケーション内ログ
- VOICEVOX: Docker logs
- RAG Backend: stdout/stderr

【監視項目】
- APIレスポンス時間
- エラー発生率
- メモリ使用量
- CPU使用率
